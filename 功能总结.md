# 运动打点器 - 功能总结文档

## 📋 项目概述

**项目名称**: 运动打点器 (Workout Beat Timer)
**项目类型**: 渐进式Web应用 (PWA)
**技术栈**: React 18 + TypeScript + Vite 5
**设计规范**: Apple iOS 17+ 人机界面指南

这是一个专为运动健身设计的节拍器应用，提供精确的节奏引导、语音计数和背景音乐功能，支持完全离线使用。

---

## 🎯 核心功能

### 1. 节拍器播放器

#### 基础功能
- **BPM 范围**: 30-200 BPM (每分钟节拍数)
- **默认速度**: 60 BPM
- **速度预设**:
  - 慢速: 45 BPM
  - 中速: 60 BPM
  - 快速: 90 BPM

#### 高级特性
- ✅ **实时调速**: 播放过程中动态调整 BPM，无需停止
- ✅ **精确时序**: 延迟 <100ms 的高精度节拍调度
- ✅ **可视化计数**: 动态显示当前节拍数 (1-20)
- ✅ **时间显示**: 实时显示已用时间和剩余时间
- ✅ **播放/暂停控制**: 随时启停节拍器

### 2. 声音系统

#### 5种内置声音类型

| 声音类型 | 技术实现 | 音效描述 |
|---------|---------|---------|
| **Beep** | 正弦波振荡器 (880Hz) | 标准电子节拍声 |
| **Tick** | 方波振荡器 (1200Hz) | 清脆的机械节拍声 |
| **Clap** | 白噪声 + 带通滤波器 | 拍手声效果 |
| **Bell** | 多谐波合成 (5个泛音) | 铃声效果 |
| **Voice** | Web Speech API | 人声节拍 (1-20计数) |

#### 语音计数功能

**核心特性**:
- 🔊 **双语支持**: 中文 (一-二十) / English (One-Twenty)
- 🎙️ **声音风格**: 男声 / 女声可选
- ⚡ **智能语速**: 根据 BPM 自动调整语音速度
- 🎚️ **独立音量**: 语音音量单独控制
- 🔄 **自动同步**: 语音与节拍完美同步

**计数范围选项**:
- 1-8
- 1-10
- 1-20 (默认)

### 3. 背景音乐系统

#### 功能特性
- 🎵 **内置音乐**: 4首专业背景音乐 (MP3格式)
- 🎛️ **独立音量**: 0-100% 无级调节
- 🔁 **循环播放**: 自动循环，不间断
- 🎚️ **音层叠**: 与节拍/语音同时播放
- ⏯️ **快速开关**: 一键启用/禁用

#### 技术实现
- 使用 Howler.js 音频库
- 与 Web Audio API 完美集成
- 支持淡入淡出效果

### 4. 计时器模式

#### 主要功能
- ⏱️ **时间范围**: 5-60 分钟可调
- 🛑 **自动停止**: 计时结束后自动停止播放
- 🔔 **浏览器通知**: 完成时弹窗提醒
- ⏳ **倒计时显示**: 实时显示剩余时间
- 🔄 **模式切换**: 可随时开启/关闭计时器

#### 使用场景
- 有氧运动时间控制
- HIIT训练间歇计时
- 康复训练时间管理

---

## ⚙️ 设置系统

### 可配置选项

#### 节拍器设置
- BPM 调整 (滑块 + 预设按钮)
- 声音类型选择 (5种声音)
- 实时速度切换

#### 语音设置
- 语音计数开关
- 语言选择 (中文/English)
- 声音风格 (男声/女声)
- 计数范围 (1-8/1-10/1-20)
- 语音音量

#### 背景音乐设置
- 背景音乐开关
- 音量控制 (0-100%)

#### 计时器设置
- 计时器模式开关
- 时长设置 (5-60分钟)

### 数据持久化

所有设置自动保存到浏览器 LocalStorage，包括:
- ✅ 用户偏好设置
- ✅ 自定义预设 (最多5个)
- ✅ 运动历史记录 (最多100条)

---

## 💾 数据管理

### 预设管理

**功能特性**:
- ➕ **创建预设**: 保存当前配置为预设
- ✏️ **编辑预设**: 修改已有预设
- 🗑️ **删除预设**: 移除不需要的预设
- 📋 **快速应用**: 一键加载预设配置

**存储限制**:
- 最多保存 5 个预设
- 自动覆盖最旧的预设 (超出限制时)

### 历史记录

**记录内容**:
- 📅 运动日期和时间
- ⏱️ 运动时长
- 🎵 BPM 设置
- 🔊 使用的声音类型
- 🗣️ 语音设置
- 🎵 背景音乐选择

**数据管理**:
- 最多保存 100 条历史记录
- 自动滚动删除旧记录
- 支持导出为 JSON 格式
- 支持导入历史数据

---

## 🌍 国际化支持

### 支持的语言

| 语言 | 代码 | 覆盖范围 |
|-----|------|---------|
| **简体中文** | zh | 完整界面翻译 |
| **English** | en | Complete UI translation |

### 国际化特性

- 🌐 **自动检测**: 根据浏览器语言自动选择
- 🔄 **手动切换**: 用户可随时切换语言
- 🔊 **语音同步**: 切换语言时自动同步人声语言
- 📱 **完整翻译**: 所有界面元素、提示信息完全翻译

---

## 🎨 设计系统

### iOS 17+ 完整设计规范

#### 颜色系统
- 🎨 10种 iOS 系统颜色
- 🌙 完整深色模式配色
- ✨ 语义化颜色命名

#### 排版系统
- 🔤 SF Pro 字体层级
- 📝 6种文字样式:
  - Title1 (大标题)
  - Headline (标题)
  - Subheadline (副标题)
  - Body (正文)
  - Callout (标注)
  - Caption (说明文字)

#### 间距系统
- 📏 iOS 8pt 网格系统
- 📐 标准间距: 4, 8, 12, 16, 20, 24, 32, 40, 48px

#### 圆角系统
- ⭕ iOS 标准圆角: 6, 8, 12, 16, 20, 24px

#### 阴影系统
- 🌑 双层阴影效果
- 💎 深度层级控制

#### 特殊效果
- 🌫️ **毛玻璃效果**: iOS 风格背景模糊 (72%/85% 透明度)
- 🎬 **流畅动画**: iOS 标准缓动曲线 (150-500ms)
- 📱 **响应式布局**: 完美适配移动端和桌面端

---

## 🔧 技术特性

### 前端技术栈

#### 核心框架
- **React 18.2.0**: 最新 React 特性
- **TypeScript 5.2.2**: 完整类型安全，严格模式
- **Vite 5.0.8**: 极速开发体验

#### 音频技术
- **Web Audio API**:
  - 实时生成节拍声音 (零外部依赖)
  - 精确时序控制 (<100ms 延迟)
  - 多种声音合成算法

- **Web Speech API**:
  - 语音合成 (Speech Synthesis)
  - 双语数字发音
  - 动态语速调整

- **Howler.js 2.2.4**:
  - 背景音乐播放
  - 音量管理
  - 循环控制

#### 国际化
- **i18next 23.7.0**: 国际化框架
- **react-i18next 14.0.0**: React 集成
- **i18next-browser-languagedetector 7.2.0**: 自动语言检测

### PWA 功能

#### 渐进式Web应用特性
- 📱 **可安装**: 安装到移动设备主屏幕
- 📴 **离线支持**: Service Worker 离线缓存
- 🔔 **通知 API**: 计时器完成通知
- 📋 **应用清单**: 完整 PWA 配置
- 🚀 **快速启动**: 即开即用

### 数据存储

#### LocalStorage 存储
- 💾 **自动保存**: 设置修改即时保存
- 🔒 **隐私优先**: 完全本地存储，无服务器
- 📊 **容量管理**: 智能管理存储空间
- 🔄 **数据导入导出**: 支持备份和恢复

---

## 📱 界面组件

### 主要界面

#### 1. 播放器界面 (Player.tsx)
- 大号计数显示卡片
- BPM 调节滑块
- 播放/暂停按钮
- 时间显示
- 设置入口

#### 2. 设置面板 (Settings.tsx)
- 分组设置项
- 即时预览
- 开关控件
- 滑块控件
- 选择器

#### 3. 预设管理 (Presets.tsx)
- 预设列表
- 添加/编辑/删除按钮
- 快速应用按钮
- 预设名称编辑

#### 4. 历史记录 (History.tsx)
- 时间线展示
- 详细信息显示
- 导出按钮
- 清空按钮

### iOS 风格组件

#### Button.tsx
- iOS 标准按钮样式
- 多种尺寸和类型
- 点击反馈动画

#### Card.tsx
- iOS 卡片容器
- 毛玻璃背景
- 圆角和阴影

#### Slider.tsx
- iOS 滑块控件
- 流畅拖动体验
- 实时数值显示

#### Toggle.tsx
- iOS 开关控件
- 平滑切换动画
- 状态反馈

#### Modal.tsx
- iOS 模态框
- 背景模糊效果
- 滑入/滑出动画

---

## 🚀 部署方案

### 支持的平台

#### Vercel 部署
- ⚡ 自动构建和部署
- 🌍 全球 CDN 加速
- 🔒 HTTPS 自动配置
- 📊 性能监控

#### GitHub Pages 部署
- 🆓 免费托管
- 🔄 GitHub Actions 自动部署
- 📦 自动构建工作流
- 🌐 自定义域名支持

### 构建配置

```javascript
{
  "base": "./",                    // 兼容 GitHub Pages
  "port": 3000,                    // 开发服务器端口
  "open": true,                    // 自动打开浏览器
  "build": {
    "outDir": "dist",              // 输出目录
    "sourcemap": true              // Source Maps
  }
}
```

---

## 🌐 浏览器兼容性

### 桌面浏览器
| 浏览器 | 最低版本 | 状态 |
|-------|---------|------|
| Chrome | 100+ | ✅ 完全支持 |
| Safari | 15+ | ✅ 完全支持 |
| Firefox | 100+ | ✅ 完全支持 |
| Edge | 100+ | ✅ 完全支持 |

### 移动浏览器
| 浏览器 | 最低版本 | 状态 |
|-------|---------|------|
| iOS Safari | 15+ | ✅ 完全支持 |
| Chrome Mobile | 最新版 | ✅ 完全支持 |
| Android Browser | 最新版 | ✅ 完全支持 |

### 必需的 Web API
- ✅ Web Audio API
- ✅ Web Speech API (Speech Synthesis)
- ✅ LocalStorage
- ✅ Notification API (可选)

---

## 💡 使用场景

### 主要应用场景

#### 1. 有氧运动
- 🏃 跑步节奏控制
- 🚴 骑行踏频管理
- 🏃‍♀️ 跳绳速度控制
- 🏊 游泳划水节奏

#### 2. 力量训练
- 🏋️ 动作节奏控制
- 💪 重复次数计数
- ⏱️ 组间休息计时
- 🎯 训练强度管理

#### 3. HIIT 训练
- 🔥 高强度间歇节奏
- ⏱️ 间歇时间控制
- 🎯 运动强度切换
- 📊 训练效果追踪

#### 4. 瑜伽/普拉提
- 🧘 呼吸节奏配合
- 🤸 动作流畅度控制
- ⏱️ 体式保持时间
- 🎵 背景音乐氛围

#### 5. 音乐练习
- 🎹 乐器练习节拍
- 🎸 节奏训练
- 🥁 速度渐变练习
- 🎼 乐曲速度参考

#### 6. 康复训练
- 🏥 医疗康复节奏
- 🚶 步态训练
- 🤸 关节活动节奏
- ⚡ 恢复期运动控制

---

## 📊 项目统计

### 代码量统计

| 类别 | 数量 | 说明 |
|-----|------|------|
| TypeScript/TSX 文件 | 19个 | 包含组件、Hooks、工具函数 |
| 总代码行数 | 2500+ | 不含注释和空行 |
| CSS (设计系统) | 426行 | iOS 17+ 完整设计规范 |
| 翻译文件 | 105行 × 2 | 中文和英文翻译 |

### 组件统计

| 类型 | 数量 |
|-----|------|
| UI 组件 | 8个 |
| 自定义 Hooks | 2个 |
| 工具模块 | 3个 |
| 类型定义 | 1个 |

### 静态资源

| 资源类型 | 数量 | 大小 |
|---------|------|------|
| 背景音乐 | 4个 MP3 | 约1.1MB |
| 图标 | 1个 SVG | - |
| PWA 配置 | 1个 JSON | - |

---

## ✨ 项目亮点

### 设计亮点
1. ✅ **严格遵循 iOS HIG**: 完整实现 iOS 17+ 设计规范
2. ✅ **原生般体验**: 毛玻璃、阴影、动画完全还原 iOS
3. ✅ **完美深色模式**: iOS 官方深色配色方案
4. ✅ **流畅动画**: iOS 标准缓动曲线和时长
5. ✅ **响应式布局**: 移动端和桌面端完美适配

### 技术亮点
1. ✅ **零外部音频依赖**: 使用 Web Audio API 实时生成声音
2. ✅ **精确时序控制**: <100ms 延迟的节拍调度
3. ✅ **实时 BPM 调整**: 播放中动态调整速度
4. ✅ **完全离线工作**: 无需服务器，隐私优先
5. ✅ **PWA 支持**: 可安装到移动设备主屏幕

### 功能亮点
1. ✅ **多语言支持**: 中英文一键切换
2. ✅ **语音计数**: Web Speech API 实现的数字朗读
3. ✅ **背景音乐**: 内置4首音乐，独立音量控制
4. ✅ **计时器模式**: 自动停止 + 浏览器通知
5. ✅ **预设管理**: 保存和快速切换运动配置
6. ✅ **历史记录**: 导出 JSON 格式的运动数据

---

## 📝 NPM 脚本

### 开发脚本

```bash
# 启动开发服务器
npm run dev
# 端口: 3000
# 特性: 热模块替换 (HMR)

# 构建生产版本
npm run build
# 流程: TypeScript 编译 + Vite 构建
# 输出: dist/ 目录

# 预览生产构建
npm run preview
# 用于本地预览生产版本

# 代码检查
npm run lint
# 使用 ESLint 检查代码质量
```

---

## 📚 项目结构

```
sonibrew/
├── .github/
│   └── workflows/
│       └── deploy.yml          # GitHub Pages 自动部署
├── public/                     # 静态资源
│   ├── manifest.json          # PWA 配置
│   ├── vite.svg              # 网站图标
│   └── *.mp3                 # 背景音乐 (4个)
├── src/
│   ├── components/            # React UI 组件
│   │   ├── Button.tsx        # iOS 按钮
│   │   ├── Card.tsx          # iOS 卡片
│   │   ├── Slider.tsx        # iOS 滑块
│   │   ├── Toggle.tsx        # iOS 开关
│   │   ├── Modal.tsx         # iOS 模态框
│   │   ├── Player.tsx        # 主播放器
│   │   ├── Settings.tsx      # 设置面板
│   │   ├── Presets.tsx       # 预设管理
│   │   └── History.tsx       # 历史记录
│   ├── hooks/                # 自定义 Hooks
│   │   ├── useAudioPlayer.ts       # 音频播放器逻辑
│   │   └── useBackgroundMusic.ts   # 背景音乐控制
│   ├── utils/                # 工具函数
│   │   ├── audioEngine.ts    # 音频引擎
│   │   ├── voiceEngine.ts    # 语音引擎
│   │   └── storage.ts        # 数据持久化
│   ├── i18n/                 # 国际化
│   │   ├── index.ts          # i18next 配置
│   │   ├── zh.ts            # 中文翻译
│   │   └── en.ts            # 英文翻译
│   ├── types.ts              # TypeScript 类型
│   ├── constants.ts          # 应用常量
│   ├── App.tsx               # 主应用组件
│   ├── main.tsx              # 应用入口
│   └── index.css             # iOS 设计系统
├── index.html                # HTML 模板
├── vite.config.js           # Vite 配置
├── tsconfig.json            # TypeScript 配置
├── vercel.json              # Vercel 部署配置
├── package.json             # 依赖和脚本
└── README.md                # 项目文档
```

---

## 🔑 核心文件说明

### 主要源文件

| 文件路径 | 功能描述 | 代码行数 |
|---------|---------|---------|
| `src/hooks/useAudioPlayer.ts` | 音频播放器核心逻辑 | 359行 |
| `src/hooks/useBackgroundMusic.ts` | 背景音乐控制 | ~100行 |
| `src/utils/audioEngine.ts` | Web Audio API 音频引擎 | ~200行 |
| `src/utils/voiceEngine.ts` | Web Speech API 语音引擎 | ~150行 |
| `src/utils/storage.ts` | LocalStorage 数据管理 | ~120行 |
| `src/components/Player.tsx` | 主播放器界面 | ~300行 |
| `src/components/Settings.tsx` | 设置面板 | ~400行 |
| `src/index.css` | iOS 17+ 设计系统 | 426行 |

---

## 🎯 适用人群

### 目标用户
- 🏋️ 健身爱好者
- 🏃‍♀️ 跑步/骑行爱好者
- 🎹 音乐学习者
- 🧘 瑜伽/普拉提练习者
- 🏥 康复训练患者
- 👨‍🏫 专业教练

### 使用优势
- ⚡ 即开即用，无需安装
- 🎨 精美的 iOS 风格界面
- 🔒 完全隐私，数据本地存储
- 📱 离线可用，无需网络
- 🎵 专业级音质和节奏控制
- 🌍 中英文双语支持

---

## 📖 总结

**运动打点器** 是一个高质量的现代化 Web 应用，具有以下核心优势：

1. **技术现代**: React 18 + TypeScript + Vite 5
2. **设计精美**: 严格遵循 iOS 17+ 设计规范
3. **功能全面**: 节拍器、语音计数、背景音乐、计时器、预设、历史
4. **体验优秀**: 实时 BPM 调整、流畅动画、离线可用
5. **代码高质量**: TypeScript 严格模式、模块化设计、可维护性强
6. **部署便捷**: 支持 Vercel 和 GitHub Pages 一键部署

该项目非常适合用于**运动健身场景**，也可作为**现代 Web 应用开发的学习范例**。

---

## 📞 技术支持

- **GitHub**: https://github.com/your-repo/sonibrew
- **在线演示**: [演示链接]
- **问题反馈**: GitHub Issues

---

*文档生成日期: 2026-01-20*
*项目版本: 1.0.0*
