import{r as ae,g as ne,i as oe,B as se,a as ie,R as v,u as I,b as m}from"./i18n-vendor-CoFQjBXR.js";import{r as le}from"./react-vendor-U3LBHqs1.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var O={exports:{}},T={};var W;function ce(){if(W)return T;W=1;var e=ae(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function d(c,i,g){var p,x={},u=null,f=null;g!==void 0&&(u=""+g),i.key!==void 0&&(u=""+i.key),i.ref!==void 0&&(f=i.ref);for(p in i)a.call(i,p)&&!s.hasOwnProperty(p)&&(x[p]=i[p]);if(c&&c.defaultProps)for(p in i=c.defaultProps,i)x[p]===void 0&&(x[p]=i[p]);return{$$typeof:r,type:c,key:u,ref:f,props:x,_owner:n.current}}return T.Fragment=t,T.jsx=d,T.jsxs=d,T}var D;function ue(){return D||(D=1,O.exports=ce()),O.exports}var o=ue(),E={},G;function de(){if(G)return E;G=1;var e=le();return E.createRoot=e.createRoot,E.hydrateRoot=e.hydrateRoot,E}var pe=de();const ge=ne(pe),xe={translation:{appTitle:"è¿åŠ¨æ‰“ç‚¹å™¨",appSubtitle:"è·ŸéšèŠ‚å¥ï¼Œç§‘å­¦è¿åŠ¨",start:"å¼€å§‹",pause:"æš‚åœ",stop:"åœæ­¢",playing:"æ’­æ”¾ä¸­",on:"å¼€å¯",off:"å…³é—­",bpm:"BPM (æ¯åˆ†é’ŸèŠ‚æ‹æ•°)",currentBpm:"å½“å‰ BPM",count:"è®¡æ•°",elapsedTime:"å·²ç”¨æ—¶é—´",remainingTime:"å‰©ä½™æ—¶é—´",timerMode:"è®¡æ—¶å™¨æ¨¡å¼",timerDuration:"æ—¶é•¿ (åˆ†é’Ÿ)",settings:"è®¾ç½®",soundSettings:"å£°éŸ³è®¾ç½®",backgroundMusic:"èƒŒæ™¯éŸ³ä¹",presets:"é¢„è®¾",history:"å†å²è®°å½•",language:"è¯­è¨€",beatVolume:"èŠ‚æ‹éŸ³é‡",soundType:"å£°éŸ³ç±»å‹",soundType_beep:"å“”å“”å£°",soundType_tick:"æ»´ç­”å£°",soundType_clap:"æ‹æ‰‹å£°",soundType_bell:"é“ƒå£°",soundType_voice:"äººå£°",soundType_custom:"è‡ªå®šä¹‰",uploadSound:"ä¸Šä¼ å£°éŸ³",preview:"é¢„è§ˆ",voiceSettings:"è¯­éŸ³æ•°æ•°è®¾ç½®",enableCount:"å¯ç”¨è¯­éŸ³æ•°æ•°",countMax:"æœ€å¤§æ•°æ•°å€¼",voiceVolume:"è¯­éŸ³éŸ³é‡",voiceLanguage:"è¯­éŸ³è¯­è¨€",voiceLanguage_zh:"ä¸­æ–‡",voiceLanguage_en:"è‹±æ–‡",voiceGender:"å£°éŸ³é£æ ¼",voiceGender_male:"ç”·å£°",voiceGender_female:"å¥³å£°",enableBackgroundMusic:"å¯ç”¨èƒŒæ™¯éŸ³ä¹",backgroundMusicVolume:"èƒŒæ™¯éŸ³ä¹éŸ³é‡",uploadMusic:"ä¸Šä¼ éŸ³ä¹",noMusicSelected:"æœªé€‰æ‹©éŸ³ä¹",bpmPresets:"BPM é¢„è®¾",slow:"æ…¢é€Ÿ",medium:"ä¸­é€Ÿ",fast:"å¿«é€Ÿ",savePreset:"ä¿å­˜é¢„è®¾",presetName:"é¢„è®¾åç§°",deletePreset:"åˆ é™¤é¢„è®¾",applyPreset:"åº”ç”¨é¢„è®¾",noPresets:"æš‚æ— é¢„è®¾",maxPresets:"æœ€å¤šä¿å­˜ 5 ä¸ªé¢„è®¾",startTime:"å¼€å§‹æ—¶é—´",duration:"æ—¶é•¿",endTime:"ç»“æŸæ—¶é—´",clearHistory:"æ¸…é™¤å†å²",exportHistory:"å¯¼å‡ºå†å²",noHistory:"æš‚æ— å†å²è®°å½•",minutes:"åˆ†é’Ÿ",seconds:"ç§’",timerComplete:"è®¡æ—¶å®Œæˆ",exerciseLogged:"é”»ç‚¼å·²è®°å½•",customSoundError:"å£°éŸ³æ–‡ä»¶ä¸æ”¯æŒï¼Œè¯·é€‰æ‹© MP3 æˆ– WAV æ ¼å¼",musicError:"éŸ³ä¹æ–‡ä»¶ä¸æ”¯æŒï¼Œè¯·é€‰æ‹© MP3 æˆ– WAV æ ¼å¼",presetSaved:"é¢„è®¾å·²ä¿å­˜",presetDeleted:"é¢„è®¾å·²åˆ é™¤",presetApplied:"é¢„è®¾å·²åº”ç”¨",numbers:["ä¸€","äºŒ","ä¸‰","å››","äº”","å…­","ä¸ƒ","å…«","ä¹","å","åä¸€","åäºŒ","åä¸‰","åå››","åäº”","åå…­","åä¸ƒ","åå…«","åä¹","äºŒå"],instructions:"ä½¿ç”¨è¯´æ˜",instructionsText:`1. è®¾ç½® BPM è°ƒæ•´èŠ‚å¥
2. é€‰æ‹©å£°éŸ³ç±»å‹æˆ–å¯ç”¨è¯­éŸ³è®¡æ•°
3. ç‚¹å‡»å¼€å§‹æŒ‰é’®
4. è·ŸéšèŠ‚æ‹è¿›è¡Œé”»ç‚¼
5. å¯é€‰æ‹©å¯ç”¨è®¡æ—¶å™¨æ¨¡å¼`,audioResources:"éŸ³é¢‘èµ„æº",audioResourcesText:"æœ¬åº”ç”¨ä½¿ç”¨ Web Audio API ç”Ÿæˆå£°éŸ³ã€‚æ‚¨ä¹Ÿå¯ä»¥ä»ä»¥ä¸‹å…è´¹èµ„æºä¸‹è½½éŸ³é¢‘æ–‡ä»¶ï¼š"}},me={translation:{appTitle:"Workout Beat Timer",appSubtitle:"Follow the Rhythm, Train Smart",start:"Start",pause:"Pause",stop:"Stop",playing:"Playing",on:"On",off:"Off",bpm:"BPM (Beats Per Minute)",currentBpm:"Current BPM",count:"Count",elapsedTime:"Elapsed Time",remainingTime:"Remaining Time",timerMode:"Timer Mode",timerDuration:"Duration (minutes)",settings:"Settings",soundSettings:"Sound Settings",backgroundMusic:"Background Music",presets:"Presets",history:"History",language:"Language",beatVolume:"Beat Volume",soundType:"Sound Type",soundType_beep:"Beep",soundType_tick:"Tick",soundType_clap:"Clap",soundType_bell:"Bell",soundType_voice:"Voice",soundType_custom:"Custom",uploadSound:"Upload Sound",preview:"Preview",voiceSettings:"Voice Counting Settings",enableCount:"Enable Voice Counting",countMax:"Maximum Count",voiceVolume:"Voice Volume",voiceLanguage:"Voice Language",voiceLanguage_zh:"Chinese",voiceLanguage_en:"English",voiceGender:"Voice Style",voiceGender_male:"Male",voiceGender_female:"Female",enableBackgroundMusic:"Enable Background Music",backgroundMusicVolume:"Background Music Volume",uploadMusic:"Upload Music",noMusicSelected:"No music selected",bpmPresets:"BPM Presets",slow:"Slow",medium:"Medium",fast:"Fast",savePreset:"Save Preset",presetName:"Preset Name",deletePreset:"Delete Preset",applyPreset:"Apply Preset",noPresets:"No presets yet",maxPresets:"Maximum 5 presets allowed",startTime:"Start Time",duration:"Duration",endTime:"End Time",clearHistory:"Clear History",exportHistory:"Export History",noHistory:"No exercise history yet",minutes:"minutes",seconds:"seconds",timerComplete:"Timer Complete",exerciseLogged:"Exercise Logged",customSoundError:"Unsupported sound format. Please use MP3 or WAV",musicError:"Unsupported music format. Please use MP3 or WAV",presetSaved:"Preset saved",presetDeleted:"Preset deleted",presetApplied:"Preset applied",numbers:["One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen","Twenty"],instructions:"Instructions",instructionsText:`1. Set BPM to adjust rhythm
2. Choose sound type or enable voice counting
3. Click start button
4. Follow the beat for exercises
5. Optionally enable timer mode`,audioResources:"Audio Resources",audioResourcesText:"This app uses Web Audio API to generate sounds. You can also download audio files from these free resources:"}},be={zh:{translation:xe.translation},en:{translation:me.translation}};oe.use(se).use(ie).init({resources:be,fallbackLng:"zh",debug:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"]}});var Y={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},U=v.createContext&&v.createContext(Y),fe=["attr","size","title"];function he(e,r){if(e==null)return{};var t=ye(e,r),a,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}function ye(e,r){if(e==null)return{};var t={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(r.indexOf(a)>=0)continue;t[a]=e[a]}return t}function _(){return _=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},_.apply(this,arguments)}function H(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function R(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?H(Object(t),!0).forEach(function(a){ve(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):H(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function ve(e,r,t){return r=we(r),r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function we(e){var r=Se(e,"string");return typeof r=="symbol"?r:r+""}function Se(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var a=t.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function K(e){return e&&e.map((r,t)=>v.createElement(r.tag,R({key:t},r.attr),K(r.child)))}function P(e){return r=>v.createElement(Te,_({attr:R({},e.attr)},r),K(e.child))}function Te(e){var r=t=>{var{attr:a,size:n,title:s}=e,d=he(e,fe),c=n||t.size||"1em",i;return t.className&&(i=t.className),e.className&&(i=(i?i+" ":"")+e.className),v.createElement("svg",_({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,d,{className:i,style:R(R({color:e.color||t.color},t.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),s&&v.createElement("title",null,s),e.children)};return U!==void 0?v.createElement(U.Consumer,null,t=>r(t)):r(Y)}function X(e){return P({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M421.84 37.37a25.86 25.86 0 0 0-22.6-4.46L199.92 86.49A32.3 32.3 0 0 0 176 118v226c0 6.74-4.36 12.56-11.11 14.83l-.12.05-52 18C92.88 383.53 80 402 80 423.91a55.54 55.54 0 0 0 23.23 45.63A54.78 54.78 0 0 0 135.34 480a55.82 55.82 0 0 0 17.75-2.93l.38-.13 21.84-7.94A47.84 47.84 0 0 0 208 423.91v-212c0-7.29 4.77-13.21 12.16-15.07l.21-.06L395 150.14a4 4 0 0 1 5 3.86v141.93c0 6.75-4.25 12.38-11.11 14.68l-.25.09-50.89 18.11A49.09 49.09 0 0 0 304 375.92a55.67 55.67 0 0 0 23.23 45.8 54.63 54.63 0 0 0 49.88 7.35l.36-.12 21.84-7.95A47.83 47.83 0 0 0 432 375.92V58a25.74 25.74 0 0 0-10.16-20.63z"},child:[]}]})(e)}function ke(e){return P({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M133 440a35.37 35.37 0 0 1-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0 1 35.77.45l247.85 148.36a36 36 0 0 1 0 61l-247.89 148.4A35.5 35.5 0 0 1 133 440z"},child:[]}]})(e)}function Ce(e){return P({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"32",d:"M320 146s24.36-12-64-12a160 160 0 1 0 160 160"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"m256 58 80 80-80 80"},child:[]}]})(e)}function Me(e){return P({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M392 432H120a40 40 0 0 1-40-40V120a40 40 0 0 1 40-40h272a40 40 0 0 1 40 40v272a40 40 0 0 1-40 40z"},child:[]}]})(e)}function Pe(e){return P({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M232 416a23.88 23.88 0 0 1-14.2-4.68 8.27 8.27 0 0 1-.66-.51L125.76 336H56a24 24 0 0 1-24-24V200a24 24 0 0 1 24-24h69.75l91.37-74.81a8.27 8.27 0 0 1 .66-.51A24 24 0 0 1 256 120v272a24 24 0 0 1-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 0 1-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0 1 28.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 0 1 320 336z"},child:[]},{tag:"path",attr:{d:"M368 384a16 16 0 0 1-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0 1 27.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 0 1-13.87 8z"},child:[]},{tag:"path",attr:{d:"M416 432a16 16 0 0 1-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1 1 27-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 0 1 416 432z"},child:[]}]})(e)}const l={log:(...e)=>{},warn:(...e)=>{console.warn(...e)},error:(...e)=>{console.error(...e)},info:(...e)=>{}},Q=({value:e,onChange:r,min:t,max:a,step:n=1,label:s,showValue:d=!0,disabled:c=!1,className:i=""})=>{const g=x=>{const u=parseFloat(x.target.value);r(u)},p=(e-t)/(a-t)*100;return o.jsxs("div",{className:`flex flex-col gap-3 ${i}`,children:[s&&o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("label",{className:"text-[15px] font-medium",style:{background:"linear-gradient(90deg, #A78BFA 0%, #EC4899 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 1px 2px rgba(167, 139, 250, 0.3))"},children:s}),d&&o.jsx("span",{className:"text-[17px] font-semibold px-3 py-1.5 rounded-lg",style:{background:"linear-gradient(135deg, #8B5CF6 0%, #EC4899 100%)",color:"#FFFFFF",boxShadow:`
                0 4px 12px rgba(139, 92, 246, 0.4),
                0 2px 6px rgba(139, 92, 246, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -1px 0 rgba(0, 0, 0, 0.3)
              `,textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)"},children:e})]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-1.5 rounded-full -translate-y-1/2 overflow-hidden",style:{background:"linear-gradient(90deg, #374151 0%, #1F2937 100%)",boxShadow:"inset 0 1px 2px rgba(0, 0, 0, 0.5)"},children:o.jsx("div",{className:"h-full transition-all duration-200",style:{width:`${p}%`,background:"linear-gradient(90deg, #10B981 0%, #14B8A6 50%, #06B6D4 100%)",boxShadow:`
                0 0 12px rgba(16, 185, 129, 0.6),
                0 0 6px rgba(16, 185, 129, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2)
              `}})}),o.jsx("input",{type:"range",value:e,onChange:g,min:t,max:a,step:n,disabled:c,className:`relative w-full h-2 appearance-none bg-transparent cursor-pointer
            [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-7 [&::-webkit-slider-thumb]:h-7
            [&::-webkit-slider-thumb]:rounded-full
            [&::-webkit-slider-thumb]:cursor-pointer
            [&::-webkit-slider-thumb]:border-0 [&::-webkit-slider-thumb]:transition-all
            [&::-webkit-slider-thumb]:duration-200 [&::-moz-range-thumb]:w-7 [&::-moz-range-thumb]:h-7
            [&::-moz-range-thumb]:rounded-full
            [&::-moz-range-thumb]:cursor-pointer
            [&::-moz-range-thumb]:border-0 [&::-moz-range-thumb]:transition-all
            [&::-moz-range-thumb]:duration-200 disabled:opacity-30 disabled:cursor-not-allowed`,style:{"--thumb-bg":"linear-gradient(135deg, #10B981 0%, #06B6D4 100%)"}}),o.jsx("style",{children:`
          input[type="range"]::-webkit-slider-thumb {
            background: linear-gradient(135deg, #10B981 0%, #06B6D4 100%);
            box-shadow:
              0 4px 16px rgba(16, 185, 129, 0.6),
              0 2px 8px rgba(16, 185, 129, 0.5),
              0 0 0 2px rgba(255, 255, 255, 0.15),
              inset 0 1px 0 rgba(255, 255, 255, 0.3),
              inset 0 -2px 0 rgba(0, 0, 0, 0.3);
          }
          input[type="range"]::-moz-range-thumb {
            background: linear-gradient(135deg, #10B981 0%, #06B6D4 100%);
            box-shadow:
              0 4px 16px rgba(16, 185, 129, 0.6),
              0 2px 8px rgba(16, 185, 129, 0.5),
              0 0 0 2px rgba(255, 255, 255, 0.15),
              inset 0 1px 0 rgba(255, 255, 255, 0.3),
              inset 0 -2px 0 rgba(0, 0, 0, 0.3);
          }
          input[type="range"]:hover::-webkit-slider-thumb {
            transform: scale(1.15);
            box-shadow:
              0 6px 20px rgba(16, 185, 129, 0.7),
              0 3px 10px rgba(16, 185, 129, 0.6),
              0 0 0 3px rgba(255, 255, 255, 0.2),
              inset 0 1px 0 rgba(255, 255, 255, 0.4),
              inset 0 -2px 0 rgba(0, 0, 0, 0.3);
          }
          input[type="range"]:hover::-moz-range-thumb {
            transform: scale(1.15);
            box-shadow:
              0 6px 20px rgba(16, 185, 129, 0.7),
              0 3px 10px rgba(16, 185, 129, 0.6),
              0 0 0 3px rgba(255, 255, 255, 0.2),
              inset 0 1px 0 rgba(255, 255, 255, 0.4),
              inset 0 -2px 0 rgba(0, 0, 0, 0.3);
          }
        `})]})]})},Be=30,je=200,Ne=60,Ee=10,A={bpm:Ne,soundType:"beep",backgroundMusicEnabled:!1,backgroundMusicVolume:.5,enableCount:!1,countMax:8,voiceLanguage:"zh",voiceGender:"female",beatVolume:.7,voiceVolume:.8,timerMode:!1,timerDuration:Ee},B={SETTINGS:"workoutbeat_settings",PRESETS:"workoutbeat_presets",HISTORY:"workoutbeat_history",LANGUAGE:"workoutbeat_language"},Ae=({bpm:e,isPlaying:r,currentCount:t,elapsedTime:a,remainingTime:n,enableCount:s,countMax:d,onStart:c,onStop:i,onBpmChange:g})=>{const{t:p}=I(),x=u=>{const f=Math.floor(u/60),w=u%60;return`${f.toString().padStart(2,"0")}:${w.toString().padStart(2,"0")}`};return o.jsxs("div",{className:"flex flex-col items-center justify-center gap-8 py-6",children:[o.jsxs("div",{className:"w-full p-4 rounded-2xl",style:{background:"linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(20, 20, 20, 0.95) 100%)",boxShadow:`
          0 4px 6px rgba(0, 0, 0, 0.4),
          0 8px 16px rgba(0, 0, 0, 0.3),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.5)
        `,border:"1px solid rgba(255, 255, 255, 0.05)"},children:[o.jsxs("div",{className:"text-center mb-3",children:[o.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[o.jsx(X,{className:"text-2xl",style:{color:"#A78BFA",filter:"drop-shadow(0 2px 4px rgba(167, 139, 250, 0.5))"}}),o.jsx("p",{className:"text-xs uppercase tracking-wider font-semibold",style:{background:"linear-gradient(135deg, #A78BFA 0%, #EC4899 50%, #F59E0B 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 2px 4px rgba(167, 139, 250, 0.3))"},children:p("currentBpm")})]}),o.jsx("p",{className:"text-5xl font-bold",style:{background:"linear-gradient(135deg, #60A5FA 0%, #A78BFA 50%, #EC4899 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 4px 8px rgba(139, 92, 246, 0.4))"},children:e||0})]}),o.jsx(Q,{value:e,onChange:u=>{g(u)},min:Be,max:je,step:1})]}),o.jsxs("div",{className:"text-center p-6 rounded-2xl",style:{background:"linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(20, 20, 20, 0.95) 100%)",boxShadow:`
          0 8px 16px rgba(0, 0, 0, 0.5),
          0 16px 32px rgba(0, 0, 0, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.5)
        `,border:"1px solid rgba(255, 255, 255, 0.05)"},children:[o.jsx("p",{className:"text-[7rem] font-bold tracking-tight leading-none font-mono",style:{background:"linear-gradient(135deg, #3B82F6 0%, #8B5CF6 25%, #EC4899 50%, #F59E0B 75%, #10B981 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 8px 16px rgba(139, 92, 246, 0.5))"},children:x(a)}),n!==void 0&&o.jsxs("p",{className:"text-xl mt-3 font-mono",style:{background:"linear-gradient(90deg, #60A5FA 0%, #A78BFA 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 2px 4px rgba(96, 165, 250, 0.4))"},children:[p("remainingTime"),": ",x(n)]})]}),o.jsxs("div",{className:"flex justify-center items-center gap-3 w-full",children:[o.jsxs("button",{onClick:()=>{},className:"flex-1 h-14 rounded-full flex items-center justify-center gap-2 transition-all duration-300 transform active:scale-95 relative overflow-hidden group",style:{background:"linear-gradient(135deg, #6366F1 0%, #8B5CF6 50%, #A855F7 100%)",boxShadow:`
              0 8px 24px rgba(139, 92, 246, 0.5),
              0 4px 12px rgba(139, 92, 246, 0.4),
              0 0 0 1px rgba(255, 255, 255, 0.1),
              inset 0 1px 0 rgba(255, 255, 255, 0.2),
              inset 0 -2px 0 rgba(0, 0, 0, 0.3)
            `},children:[o.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:{background:"radial-gradient(circle at center, rgba(255, 255, 255, 0.2) 0%, transparent 70%)"}}),o.jsx(Ce,{className:"text-2xl text-white relative z-10",style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))"}}),o.jsx("span",{className:"text-white text-base font-semibold relative z-10",style:{textShadow:"0 2px 4px rgba(0, 0, 0, 0.3)"},children:p("reset")})]}),o.jsxs("button",{onClick:()=>{r?i():c()},className:"flex-1 h-14 rounded-full flex items-center justify-center gap-2 transition-all duration-300 transform active:scale-95 relative overflow-hidden group",style:{background:r?"linear-gradient(135deg, #EF4444 0%, #F97316 50%, #F59E0B 100%)":"linear-gradient(135deg, #10B981 0%, #14B8A6 50%, #06B6D4 100%)",boxShadow:r?`
                0 8px 32px rgba(239, 68, 68, 0.6),
                0 4px 16px rgba(239, 68, 68, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -2px 0 rgba(0, 0, 0, 0.3)
              `:`
                0 8px 32px rgba(16, 185, 129, 0.6),
                0 4px 16px rgba(16, 185, 129, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -2px 0 rgba(0, 0, 0, 0.3)
              `},children:[o.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:{background:"radial-gradient(circle at center, rgba(255, 255, 255, 0.2) 0%, transparent 70%)"}}),r?o.jsx(Me,{className:"text-2xl text-white relative z-10",style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))"}}):o.jsx(ke,{className:"text-2xl text-white relative z-10",style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3))"}}),o.jsx("span",{className:"text-white text-base font-semibold relative z-10",style:{textShadow:"0 2px 4px rgba(0, 0, 0, 0.3)"},children:p(r?"stop":"start")})]})]}),s&&o.jsxs("div",{className:"w-full p-4 rounded-2xl",style:{background:"linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(20, 20, 20, 0.95) 100%)",boxShadow:`
            0 4px 6px rgba(0, 0, 0, 0.4),
            0 8px 16px rgba(0, 0, 0, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.1),
            inset 0 -1px 0 rgba(0, 0, 0, 0.5)
          `,border:"1px solid rgba(255, 255, 255, 0.05)"},children:[o.jsx("p",{className:"text-xs uppercase tracking-wider mb-3 text-center font-semibold",style:{background:"linear-gradient(90deg, #F59E0B 0%, #EC4899 50%, #8B5CF6 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 2px 4px rgba(245, 158, 11, 0.3))"},children:p("count")}),o.jsx("div",{className:"flex justify-center gap-2 flex-wrap",children:Array.from({length:Math.min(d,8)},(u,f)=>f+1).map(u=>o.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center font-bold text-base transition-all duration-300 ${u===t?"scale-110":""}`,style:{background:u===t?"linear-gradient(135deg, #10B981 0%, #14B8A6 50%, #06B6D4 100%)":u<t?"linear-gradient(135deg, #6B7280 0%, #4B5563 100%)":"linear-gradient(135deg, #374151 0%, #1F2937 100%)",color:"#FFFFFF",boxShadow:u===t?`
                      0 4px 16px rgba(16, 185, 129, 0.5),
                      0 2px 8px rgba(16, 185, 129, 0.4),
                      0 0 0 1px rgba(255, 255, 255, 0.1),
                      inset 0 1px 0 rgba(255, 255, 255, 0.2),
                      inset 0 -1px 0 rgba(0, 0, 0, 0.3)
                    `:`
                      0 2px 8px rgba(0, 0, 0, 0.3),
                      inset 0 1px 0 rgba(255, 255, 255, 0.05),
                      inset 0 -1px 0 rgba(0, 0, 0, 0.3)
                    `,border:u>t?"1px solid rgba(255, 255, 255, 0.1)":"none",opacity:u<t?.5:1,textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)"},children:u},u))})]})]})},Fe=({checked:e,onChange:r,label:t,disabled:a=!1})=>o.jsxs("button",{onClick:()=>!a&&r(!e),disabled:a,className:`
        relative w-16 h-8 rounded-full transition-all duration-300 shadow-md
        ${e?"bg-gradient-to-r from-[var(--primary-color)] to-[#667eea]":"bg-[var(--border-color)]"}
        ${a?"opacity-50 cursor-not-allowed":"cursor-pointer hover:shadow-lg"}
      `,"aria-pressed":e,role:"switch",children:[o.jsx("div",{className:`
          absolute top-1 w-6 h-6 bg-white rounded-full shadow-md transition-all duration-300
          ${e?"translate-x-9":"translate-x-1"}
          ${e?"shadow-[var(--shadow-primary)]":""}
        `}),t&&o.jsx("span",{className:"sr-only",children:t})]}),_e=({settings:e,onChange:r})=>{const{t}=I(),a=(n,s)=>{r({...e,[n]:s})};return o.jsxs("div",{className:"flex flex-col gap-6",children:[o.jsxs("div",{className:"space-y-3 p-4 rounded-2xl",style:{background:"linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(20, 20, 20, 0.95) 100%)",boxShadow:`
          0 4px 6px rgba(0, 0, 0, 0.4),
          0 8px 16px rgba(0, 0, 0, 0.3),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.5)
        `,border:"1px solid rgba(255, 255, 255, 0.05)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(X,{className:"text-xl",style:{color:"#A78BFA",filter:"drop-shadow(0 2px 4px rgba(167, 139, 250, 0.5))"}}),o.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider",style:{background:"linear-gradient(90deg, #A78BFA 0%, #EC4899 50%, #F59E0B 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 2px 4px rgba(167, 139, 250, 0.3))"},children:t("backgroundMusic")})]}),o.jsxs("div",{className:"flex items-center justify-between py-2",children:[o.jsx("label",{className:"text-base font-medium",style:{background:"linear-gradient(90deg, #60A5FA 0%, #A78BFA 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 1px 2px rgba(96, 165, 250, 0.3))"},children:t("backgroundMusic")}),o.jsx(Fe,{checked:e.backgroundMusicEnabled,onChange:n=>a("backgroundMusicEnabled",n),label:e.backgroundMusicEnabled?t("on"):t("off")})]}),o.jsx("div",{className:"py-2",children:o.jsx(Q,{label:t("backgroundMusicVolume"),value:e.backgroundMusicVolume,onChange:n=>a("backgroundMusicVolume",n),min:0,max:1,step:.05})})]}),o.jsxs("div",{className:"space-y-3 p-4 rounded-2xl",style:{background:"linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(20, 20, 20, 0.95) 100%)",boxShadow:`
          0 4px 6px rgba(0, 0, 0, 0.4),
          0 8px 16px rgba(0, 0, 0, 0.3),
          inset 0 1px 0 rgba(255, 255, 255, 0.1),
          inset 0 -1px 0 rgba(0, 0, 0, 0.5)
        `,border:"1px solid rgba(255, 255, 255, 0.05)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(Pe,{className:"text-xl",style:{color:"#10B981",filter:"drop-shadow(0 2px 4px rgba(16, 185, 129, 0.5))"}}),o.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider",style:{background:"linear-gradient(90deg, #10B981 0%, #14B8A6 50%, #06B6D4 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 2px 4px rgba(16, 185, 129, 0.3))"},children:t("soundSettings")})]}),o.jsxs("div",{className:"py-2",children:[o.jsx("label",{className:"block text-sm font-medium mb-2",style:{background:"linear-gradient(90deg, #8B5CF6 0%, #EC4899 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",filter:"drop-shadow(0 1px 2px rgba(139, 92, 246, 0.3))"},children:t("soundType")}),o.jsxs("select",{value:e.soundType,onChange:n=>a("soundType",n.target.value),className:"w-full px-4 py-2 rounded-lg border transition-all duration-200 focus:outline-none",style:{background:"linear-gradient(135deg, #1F2937 0%, #111827 100%)",borderColor:"rgba(139, 92, 246, 0.3)",color:"#FFFFFF",boxShadow:`
                0 2px 8px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.05),
                inset 0 -1px 0 rgba(0, 0, 0, 0.3)
              `},children:[o.jsx("option",{value:"beep",children:t("soundType_beep")}),o.jsx("option",{value:"tick",children:t("soundType_tick")}),o.jsx("option",{value:"clap",children:t("soundType_clap")}),o.jsx("option",{value:"bell",children:t("soundType_bell")}),o.jsx("option",{value:"voice",children:t("soundType_voice")})]})]})]})]})},Re=({variant:e="primary",size:r="md",fullWidth:t=!1,children:a,className:n="",...s})=>{const d="font-semibold rounded-[var(--radius-lg)] transition-all disabled:opacity-30 disabled:cursor-not-allowed relative overflow-hidden",c={primary:"bg-[var(--primary-color)] text-white active:bg-[var(--primary-hover)] shadow-[var(--shadow-sm)]",secondary:"bg-[var(--surface-color)] text-[var(--primary-color)] active:bg-[var(--surface-hover)] border border-[var(--separator-color)]",danger:"bg-[var(--danger-color)] text-white active:opacity-80 shadow-[var(--shadow-sm)]",success:"bg-[var(--success-color)] text-white active:opacity-80 shadow-[var(--shadow-sm)]",ghost:"bg-transparent text-[var(--primary-color)] active:bg-[var(--primary-light)]"},i={sm:"px-4 py-2 text-[15px] font-semibold",md:"px-5 py-2.5 text-[17px] font-semibold",lg:"px-6 py-3 text-[20px] font-semibold",xl:"px-8 py-4 text-[22px] font-bold"},g=t?"w-full":"";return o.jsx("button",{className:`${d} ${c[e]} ${i[r]} ${g} ${n}`,...s,children:o.jsx("span",{className:"relative z-10",children:a})})};let S=null;const Oe=()=>((!S||S.length===0)&&(S=window.speechSynthesis.getVoices(),l.info("Voices loaded and cached:",S.length)),S);"speechSynthesis"in window&&(window.speechSynthesis.onvoiceschanged=()=>{S=window.speechSynthesis.getVoices(),l.info("Voices cache refreshed:",S.length)});const V=(e,r,t,a,n,s)=>new Promise((d,c)=>{try{const i=s||Ve(e,r);if(l.log("è¯­éŸ³åˆæˆå¼€å§‹:",{text:i,language:r,gender:t,volume:a,rate:n,customText:s}),!("speechSynthesis"in window)){const u=new Error("æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ");l.error(u.message),c(u);return}const g=new SpeechSynthesisUtterance(i);g.lang=r==="zh"?"zh-CN":"en-US",g.volume=a,g.rate=n,g.pitch=t==="male"?.8:1.2;const p=Oe();l.log("å¯ç”¨è¯­éŸ³æ•°é‡:",p.length);const x=ze(p,r,t);x?(g.voice=x,l.log("é€‰æ‹©çš„è¯­éŸ³:",x.name,x.lang)):l.warn("æœªæ‰¾åˆ°åˆé€‚çš„è¯­éŸ³ï¼Œä½¿ç”¨é»˜è®¤è¯­éŸ³"),g.onend=()=>{l.log("è¯­éŸ³åˆæˆå®Œæˆ:",i),d()},g.onerror=u=>{l.error("è¯­éŸ³åˆæˆé”™è¯¯:",{error:u.error,text:i,utterance:u.utterance?.text}),u.error==="interrupted"||u.error==="canceled"?(l.log("è¯­éŸ³è¢«ä¸­æ–­ï¼Œè§†ä¸ºæ­£å¸¸"),d()):c(u)},window.speechSynthesis.speak(g),l.log("è¯­éŸ³åˆæˆè¯·æ±‚å·²å‘é€")}catch(i){l.error("è¯­éŸ³åˆæˆå¼‚å¸¸:",i),c(i)}}),Ve=(e,r)=>r==="zh"?Le(e):Ie(e),Le=e=>{const r=["ä¸€","äºŒ","ä¸‰","å››","äº”","å…­","ä¸ƒ","å…«","ä¹","å","åä¸€","åäºŒ","åä¸‰","åå››","åäº”","åå…­","åä¸ƒ","åå…«","åä¹","äºŒå"];return e<=20?r[e-1]:e.toString()},Ie=e=>{const r=["One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen","Twenty"];return e<=20?r[e-1]:e.toString()},ze=(e,r,t)=>{const a=r==="zh"?"zh":"en",n=e.filter(d=>d.lang.toLowerCase().startsWith(a));if(n.length===0)return null;const s=t==="male"?["male","david","daniel","james","google male"]:["female","zira","karen","samantha","google female","huihui","yaoyao"];for(const d of n){const c=d.name.toLowerCase();if(s.some(i=>c.includes(i)))return d}return n[0]},k=()=>{window.speechSynthesis.cancel()},q=()=>"speechSynthesis"in window,L=e=>{let a=1*(e/60);return a=Math.min(Math.max(a,.5),2.5),a},We=200,De=20,Ge=5*1024*1024;let F=null;const Z=()=>{if(!F||F.state==="closed")try{F=new(window.AudioContext||window.webkitAudioContext),l.info("AudioContext created/recreated")}catch(e){throw l.error("Failed to create AudioContext:",e),new Error("Web Audio API not supported")}return F},Ue=e=>{if(!e||typeof e!="string")return!1;if(e.startsWith("data:")){const t=(e.split(",")[1]?.length||0)*3/4;if(t>Ge)return l.warn("Custom sound exceeds size limit:",t),!1}if(e.startsWith("http"))try{new URL(e)}catch{return l.warn("Invalid custom sound URL:",e),!1}return!0},He=(e,r,t)=>new Promise((a,n)=>{try{if(e==="custom"&&t){if(!Ue(t)){n(new Error("Invalid custom sound data"));return}Ke(t,r).then(()=>a()).catch(n);return}const s=Z(),d=s.currentTime,c=s.createGain();switch(c.connect(s.destination),c.gain.setValueAtTime(r,d),e){case"beep":$(s,c,d);break;case"tick":$e(s,c,d);break;case"clap":Je(s,c,d);break;case"bell":Ye(s,c,d);break;case"voice":a();return;default:$(s,c,d)}setTimeout(()=>a(),We)}catch(s){l.error("Error playing beat sound:",s),n(s)}});let M=1;const qe=(e,r,t,a)=>{const n=M;M++,M>De&&(M=1);const s=L(a);return V(n,e,r,t,s)},ee=()=>{M=1},$=(e,r,t)=>{const a=e.createOscillator();a.type="sine",a.frequency.setValueAtTime(880,t),a.connect(r),a.start(t),a.stop(t+.1),r.gain.exponentialRampToValueAtTime(.01,t+.1)},$e=(e,r,t)=>{const a=e.createOscillator();a.type="square",a.frequency.setValueAtTime(1200,t),a.connect(r),a.start(t),a.stop(t+.05),r.gain.exponentialRampToValueAtTime(.01,t+.05)},Je=(e,r,t)=>{const a=e.sampleRate*.1,n=e.createBuffer(1,a,e.sampleRate),s=n.getChannelData(0);for(let i=0;i<a;i++)s[i]=Math.random()*2-1;const d=e.createBufferSource();d.buffer=n;const c=e.createBiquadFilter();c.type="bandpass",c.frequency.value=1500,d.connect(c),c.connect(r),d.start(t),r.gain.exponentialRampToValueAtTime(.01,t+.1)},Ye=(e,r,t)=>{const n=[1,2,3,4.2,5.8],s=[1,.6,.4,.25,.2];n.forEach((d,c)=>{const i=e.createOscillator(),g=e.createGain();i.type="sine",i.frequency.value=523.25*d,i.connect(g),g.connect(r),g.gain.setValueAtTime(s[c]*.3,t),g.gain.exponentialRampToValueAtTime(.01,t+.5),i.start(t),i.stop(t+.5)}),r.gain.exponentialRampToValueAtTime(.01,t+.5)},Ke=async(e,r)=>new Promise((t,a)=>{const n=new Audio(e);n.volume=r,n.onended=()=>t(),n.onerror=s=>{l.error("Failed to load custom sound:",s),a(new Error("Failed to load custom sound"))},n.play().catch(s=>{l.error("Failed to play custom sound:",s),a(s)})}),Xe=async()=>{try{const e=Z();e.state==="suspended"&&(await e.resume(),l.info("AudioContext resumed"))}catch(e){throw l.error("Failed to resume AudioContext:",e),e}},Qe=100,z=()=>{try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return l.error("localStorage is not available:",e),!1}},te=(e,r)=>{if(!z())return!1;try{return localStorage.setItem(e,r),!0}catch(t){if(t.name==="QuotaExceededError"){l.error("localStorage quota exceeded");try{return localStorage.removeItem(B.HISTORY),localStorage.setItem(e,r),l.info("Freed up space by removing history"),!0}catch{return l.error("Failed to free up space"),!1}}return l.error("Failed to save to localStorage:",t),!1}},Ze=e=>{const{backgroundMusicFile:r,customSoundData:t,...a}=e;te(B.SETTINGS,JSON.stringify(a))||l.warn("Failed to save settings")},J=()=>{if(!z())return A;const e=localStorage.getItem(B.SETTINGS);if(e)try{const r=JSON.parse(e);return{...A,...r}}catch(r){return l.error("Failed to parse settings:",r),A}return A},et=e=>{te(B.HISTORY,JSON.stringify(e))||l.warn("Failed to save history")},tt=()=>{if(!z())return[];const e=localStorage.getItem(B.HISTORY);if(e)try{return JSON.parse(e)}catch(r){return l.error("Failed to parse history:",r),[]}return[]},rt=e=>{const r=tt();r.unshift(e),r.length>Qe&&r.pop(),et(r)},at=({settings:e,onTimerComplete:r})=>{const[t,a]=m.useState({isPlaying:!1,isPaused:!1,currentBPM:e.bpm,currentCount:0,elapsedTime:0,remainingTime:e.timerMode?e.timerDuration*60:void 0}),n=m.useRef(null),s=m.useRef(0),d=m.useRef(e.bpm),c=m.useRef(!1);m.useEffect(()=>{d.current=t.currentBPM,c.current=t.isPlaying},[t.currentBPM,t.isPlaying]);const i=m.useCallback(async()=>{try{await Xe();try{e.soundType==="voice"?(l.log("ä½¿ç”¨äººå£°èŠ‚æ‹:",e.soundType,"BPM:",d.current),await qe(e.voiceLanguage,e.voiceGender,e.beatVolume,d.current),l.log("äººå£°èŠ‚æ‹æ’­æ”¾å®Œæˆ")):await He(e.soundType,e.beatVolume,e.customSoundData)}catch(b){l.error("æ’­æ”¾èŠ‚æ‹å£°éŸ³é”™è¯¯:",b),e.soundType==="voice"&&l.log("äººå£°èŠ‚æ‹é”™è¯¯è¯¦æƒ…:",{error:b,language:e.voiceLanguage,gender:e.voiceGender,volume:e.beatVolume,bpm:d.current})}}catch(b){l.error("Error in beat playback:",b)}},[e.soundType,e.voiceLanguage,e.voiceGender,e.beatVolume,e.customSoundData]),g=m.useCallback(()=>{l.log("ğŸ”” èŠ‚æ‹è§¦å‘ï¼ŒBPM:",d.current);let b=!0;return a(h=>{const j=Math.floor((Date.now()-s.current)/1e3);let y=h.currentCount+1;if(e.enableCount&&y>e.countMax&&(y=1),e.timerMode&&h.remainingTime!==void 0){const N=h.remainingTime-1;if(N<=0)return b=!1,r?.(),h;if(i(),e.enableCount&&q()&&y<=e.countMax){const re=L(h.currentBPM);V(y,e.voiceLanguage,e.voiceGender,e.voiceVolume,re).catch(()=>{})}return{...h,currentCount:y,elapsedTime:j,remainingTime:N}}if(i(),e.enableCount&&q()&&y<=e.countMax){const N=L(h.currentBPM);V(y,e.voiceLanguage,e.voiceGender,e.voiceVolume,N).catch(()=>{})}return{...h,currentCount:y,elapsedTime:j}}),b},[e.timerMode,e.timerDuration,r,i,e.enableCount,e.countMax,e.voiceLanguage,e.voiceGender,e.voiceVolume]),p=m.useCallback(()=>{const b=d.current,h=60/b*1e3;l.log("â° è°ƒåº¦ä¸‹ä¸€æ¬¡èŠ‚æ‹ï¼ŒBPM:",b,"å»¶è¿Ÿ:",h,"ms","isPlaying:",c.current),n.current&&(clearTimeout(n.current),n.current=null);const j=setTimeout(()=>{if(!c.current)return;if(!g()){n.current&&(clearTimeout(n.current),n.current=null),c.current=!1,k(),a({isPlaying:!1,isPaused:!1,currentBPM:e.bpm,currentCount:0,elapsedTime:0,remainingTime:e.timerMode?e.timerDuration*60:void 0});return}c.current&&p()},h);n.current=j},[g,e.bpm,e.timerMode,e.timerDuration]),x=m.useCallback(()=>{t.isPlaying||(l.log("start() è¢«è°ƒç”¨ï¼Œå½“å‰BPM:",t.currentBPM),s.current=Date.now(),ee(),c.current=!0,a(b=>({...b,isPlaying:!0,isPaused:!1})),i(),p())},[t.isPlaying,i,p]),u=m.useCallback(()=>{!t.isPlaying||t.isPaused||(n.current&&(clearTimeout(n.current),n.current=null),c.current=!1,k(),a(b=>({...b,isPlaying:!1,isPaused:!0})))},[t.isPlaying,t.isPaused]),f=m.useCallback(()=>{if(n.current&&(clearTimeout(n.current),n.current=null),c.current=!1,k(),t.elapsedTime>0){const b={id:Date.now().toString(),startTime:s.current,endTime:Date.now(),duration:t.elapsedTime,bpm:t.currentBPM,soundType:e.soundType,enableCount:e.enableCount,countMax:e.countMax};rt(b)}a({isPlaying:!1,isPaused:!1,currentBPM:e.bpm,currentCount:0,elapsedTime:0,remainingTime:e.timerMode?e.timerDuration*60:void 0})},[t,e]),w=m.useCallback(b=>{l.log("updateBPM() è¢«è°ƒç”¨ï¼Œæ–°BPM:",b,"å½“å‰ ref BPM:",d.current),d.current=b,a(h=>({...h,currentBPM:b})),e.soundType==="voice"&&c.current&&k(),c.current&&n.current&&(clearTimeout(n.current),n.current=null,p())},[p,e.soundType]);return m.useEffect(()=>()=>{n.current&&clearTimeout(n.current),k()},[]),{playerState:t,start:x,pause:u,stop:f,updateBPM:w}},C=["/xm2544.mp3","/xm3242.mp3","/xm3251.mp3","/y1891.mp3"],nt=({enabled:e,volume:r})=>{const t=m.useRef([]),a=m.useRef(0),[n,s]=m.useState(!1),[d,c]=m.useState(!1);m.useEffect(()=>(t.current=C.map(u=>{const f=new Audio(u);return f.loop=!1,f.preload="auto",f}),()=>{t.current.forEach(u=>{u.pause(),u.src=""}),t.current=[]}),[]),m.useEffect(()=>{t.current.forEach(u=>{u.volume=r})},[r]);const i=()=>{if(!e){l.warn("âš ï¸ èƒŒæ™¯éŸ³ä¹æœªå¯ç”¨ï¼Œè·³è¿‡æ’­æ”¾");return}if(t.current.length===0){l.error("âŒ éŸ³é¢‘å…ƒç´ æœªåˆå§‹åŒ–");return}const u=a.current,f=t.current[u];l.log(`ğŸµ å°è¯•æ’­æ”¾æ›²ç›® ${u+1}/${C.length}:`,C[u]),l.log("éŸ³é¢‘å…ƒç´ çŠ¶æ€:",{src:f.src,readyState:f.readyState,volume:f.volume}),f.onended=()=>{a.current=(a.current+1)%C.length,i()},f.onerror=w=>{l.error("âŒ éŸ³é¢‘æ’­æ”¾é”™è¯¯:",w),c(!1)},f.play().then(()=>{s(!0),c(!1),l.log("âœ… èƒŒæ™¯éŸ³ä¹æ’­æ”¾æˆåŠŸ! å½“å‰æ›²ç›®:",C[u])}).catch(w=>{l.error("âŒ èƒŒæ™¯éŸ³ä¹æ’­æ”¾å¤±è´¥:",w),c(!1)})};return{isPlaying:n,isLoading:d,play:async()=>{if(l.log("ğŸµ æ’­æ”¾èƒŒæ™¯éŸ³ä¹è¯·æ±‚",{enabled:e,volume:r,isPlaying:t.current.length>0}),!e){l.warn("âš ï¸ èƒŒæ™¯éŸ³ä¹æœªå¯ç”¨");return}if(t.current.length===0){l.error("âŒ èƒŒæ™¯éŸ³ä¹æ–‡ä»¶æœªåŠ è½½");return}c(!0),i()},pause:()=>{t.current.forEach(u=>{u.pause()}),s(!1)},stop:()=>{t.current.forEach(u=>{u.pause(),u.currentTime=0}),a.current=0,s(!1)},updateMusicFile:()=>{}}};function ot(){const{t:e,i18n:r}=I(),[t,a]=m.useState(J()),n=nt({enabled:t.backgroundMusicEnabled,volume:t.backgroundMusicVolume,musicFile:t.backgroundMusicFile}),s=at({settings:t,onTimerComplete:()=>{i(),Notification.permission==="granted"&&new Notification(e("timerComplete"),{body:e("exerciseLogged"),icon:"/vite.svg"})}});m.useEffect(()=>{const x=J();a(x)},[]),m.useEffect(()=>{Ze(t)},[t]),m.useEffect(()=>{"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()},[]),m.useEffect(()=>{l.log("èƒŒæ™¯éŸ³ä¹çŠ¶æ€å˜åŒ–:",t.backgroundMusicEnabled),t.backgroundMusicEnabled?n.play().then(()=>l.log("âœ… èƒŒæ™¯éŸ³ä¹è‡ªåŠ¨æ’­æ”¾æˆåŠŸ")).catch(x=>l.error("âŒ èƒŒæ™¯éŸ³ä¹è‡ªåŠ¨æ’­æ”¾å¤±è´¥:",x)):n.stop()},[t.backgroundMusicEnabled]);const d=()=>{l.log("å¼€å§‹æ’­æ”¾èŠ‚æ‹å™¨",{bgMusicEnabled:t.backgroundMusicEnabled}),s.start()},c=()=>{i()},i=()=>{s.stop(),n.stop(),ee()},g=x=>{l.log("=== handleBpmChange è¢«è°ƒç”¨ï¼Œæ–°BPM:",x,"å½“å‰settings.bpm:",t.bpm),a(u=>({...u,bpm:x})),s.updateBPM(x)},p=x=>{r.changeLanguage(x),a(u=>({...u,voiceLanguage:x}))};return o.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{background:"radial-gradient(circle at 50% 0%, #2C2C2E 0%, #1C1C1E 50%, #000000 100%)"},children:o.jsx("div",{className:"relative",style:{padding:"3px"},children:o.jsx("div",{className:"relative overflow-hidden",style:{width:"430px",height:"932px",maxWidth:"100vw",maxHeight:"100vh",borderRadius:"55px",background:"linear-gradient(135deg, #4A4A4C 0%, #2C2C2E 25%, #1C1C1E 50%, #2C2C2E 75%, #4A4A4C 100%)",padding:"2px",boxShadow:`
              0 0 0 1px rgba(255, 255, 255, 0.1),
              0 2px 4px rgba(0, 0, 0, 0.3),
              0 8px 16px rgba(0, 0, 0, 0.4),
              0 16px 32px rgba(0, 0, 0, 0.5),
              inset 0 1px 0 rgba(255, 255, 255, 0.15),
              inset 0 -1px 0 rgba(0, 0, 0, 0.5)
            `},children:o.jsxs("div",{className:"relative bg-[var(--background-color)] overflow-hidden h-full",style:{borderRadius:"53px",boxShadow:"inset 0 0 0 1px rgba(0, 0, 0, 0.3), inset 0 2px 8px rgba(0, 0, 0, 0.4)"},children:[o.jsx("div",{className:"absolute top-[20px] left-1/2 -translate-x-1/2 z-50",children:o.jsx("div",{style:{width:"126px",height:"37px",borderRadius:"19px",background:"#000000",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.8), inset 0 1px 2px rgba(255, 255, 255, 0.05)"}})}),o.jsx("div",{className:"h-[59px] bg-[var(--background-color)]"}),o.jsx("header",{className:"border-b border-[var(--separator-color)] bg-[var(--surface-color)]",children:o.jsx("div",{className:"px-4 py-4",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("div",{children:o.jsx("h1",{className:"text-xl font-bold text-[var(--text-primary)]",children:e("appTitle")})}),o.jsx(Re,{variant:"secondary",size:"sm",onClick:()=>p(r.language==="zh"?"en":"zh"),className:"!font-semibold",children:r.language==="zh"?"EN":"ä¸­æ–‡"})]})})}),o.jsx("main",{className:"px-4",children:o.jsx(Ae,{bpm:s.playerState.currentBPM,isPlaying:s.playerState.isPlaying,currentCount:s.playerState.currentCount,elapsedTime:s.playerState.elapsedTime,remainingTime:s.playerState.remainingTime,enableCount:t.enableCount,countMax:t.countMax,onStart:d,onStop:c,onBpmChange:g})}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 border-t border-[var(--separator-color)] bg-[var(--surface-color)] max-h-[40vh] overflow-y-auto pb-[34px]",children:o.jsx("div",{className:"px-4 py-4",children:o.jsx(_e,{settings:t,onChange:a})})}),o.jsx("div",{className:"absolute bottom-[8px] left-1/2 -translate-x-1/2",children:o.jsx("div",{style:{width:"134px",height:"5px",borderRadius:"100px",background:"rgba(255, 255, 255, 0.3)"}})})]})})})})}ge.createRoot(document.getElementById("root")).render(o.jsx(v.StrictMode,{children:o.jsx(ot,{})}));
